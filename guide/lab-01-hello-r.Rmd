---
title: "Lab X - Accessibility"
output: 
  tufte::tufte_html:
    css: ../lab.css
    tufte_variant: "envisioned"
    highlight: pygments
link-citations: yes
---

The main goal of this lab is to introduce you to elements of accessibility in data visualization which you will be using in your final projects.

## Packages

In this lab we will work with two packages: **openintro** which contains the dataset we'll be using and **tidyverse** which is a collection of packages for doing data analysis in a "tidy" way. We will also be using the **countrycode** package to run certain visualizations.

These packages are already installed for you.
You can load the packages by running the following in the Console.

```{r message=FALSE}
library(tidyverse) 
library(openintro)
library(countrycode)
library(ggplot2)
library(ggpattern)
```

Note that the packages are also loaded with the same commands in your R Markdown document.

## Datas

The data frames we will be working with today are called `chocolate` and `penguins` and are both from the `TidyTuesday` GitHub repository.

You can load the data frames by running the following in the Console.

```{r load-data, message=FALSE}
chocolate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-18/chocolate.csv')
penguins <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-28/penguins.csv')
```


# Exercises

1.  Please watch Amy Cesal's guide to writing alternative text for data visualization from "name of conference" found on [Youtube](https://www.youtube.com/watch?v=nBcR95S0F0o). According to this video, what are the three components that alternative text for data visualization should include?

üß∂ ‚úÖ ‚¨ÜÔ∏è *Knit, commit, and push your changes to GitHub with the commit message "Add answer for Ex 1". Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.*

```{r}
chocolate <- chocolate %>%
  mutate(continent = countrycode(country_of_bean_origin, origin  = "country.name", destination = "continent"))
```

```{r plot-chocolate}
chocolate %>%
  #narrow down to specific continent
  filter(company_location == "U.S.A.", country_of_bean_origin != "Blend") %>%
  group_by(country_of_bean_origin, continent) %>%
  summarise(count = n()) %>%
  #summarise(mean_cocoa_percent = mean(as.numeric(substr(cocoa_percent, start = 1, stop = 2)), na.rm = TRUE)) %>%
  ggplot(mapping = aes(x = fct_reorder(country_of_bean_origin, count), y = count, fill = continent)) +
  geom_col() + 
  coord_flip() +
  labs(title = "Bean Origin of Chocolate Bars Manufactured in the U.S.A.", y = "Number of Chocolate Bars Manufactured in the U.S.A.", x = "Country of Bean Origin", fill = "Continent") +
  scale_fill_viridis_d() 
```

2. With this in mind, justify why each of the four alternative text examples below describing the above image meets or doesn't meet standards for alternative text for data visualizations: 

I. Bar chart where 20 of the 38 countries are in the Americas, 11 of the 38 countries are in Africa, and the Dominican Republic, Peru, Venezuela, and Ecuador are the top four countries responsible for 154, 115, 87, and 86 bars respectively. 

II. Bar chart of the number of chocolate bars manufactured in the U.S.A by country and continent of bean origin where 20 of the 38 countries are in the Americas, 11 of the 38 countries are in Africa, and the Dominican Republic, Peru, Venezuela, and Ecuador are the top four countries responsible for 154, 115, 87, and 86 bars respectively. 

III. Bar chart of the number of chocolate bars manufactured in the U.S.A by country and continent of bean origin.

IV. Number of chocolate bars manufactured in the U.S.A by country and continent of bean origin where 20 of the 38 countries are in the Americas, 11 of the 38 countries are in Africa, and the Dominican Republic, Peru, Venezuela, and Ecuador are the top four countries responsible for 154, 115, 87, and 86 bars respectively. 

üß∂ ‚úÖ ‚¨ÜÔ∏è *Knit, commit, and push your changes to GitHub with the commit message "Add answer for Ex 2". Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.*

3. Now, try your hand at making data visualizations more accessible by focusing on the color palette and alternative text of this data visualization. Remember to include the chart type, type of data, and reason for including the chart in your alternative text:

```{r plot-penguins}
penguins %>%
  group_by(species) %>%
  summarise(mean_bill = mean(bill_length_mm, na.rm = TRUE)) %>%
  ggplot(mapping = aes(x = fct_reorder(species, mean_bill), y = mean_bill, fill = species)) +
  geom_col() + 
  coord_flip() +
  labs(title = "Average Bill Length of Three Penguin Species", x = "Penguin Species", y = "Average Bill Length in Millimeters", fill = "Penguin Species") 
```

üß∂ ‚úÖ ‚¨ÜÔ∏è *This is another good place to pause, knit, commit changes with the commit message "Add answer for Ex 3", and push. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.*

4. Observe the following use of accessible color palettes and patterns to make below visualization accessible:

```{r}

sample_dataframe <- data.frame(Categories = c("a", "b", "c", 'd'), Values = c(2.3, 1.9, 3.2, 1))

sample_plot <- ggplot(sample_dataframe, aes(Categories, Values)) +
  geom_col_pattern(
    aes(pattern = Categories, fill = Categories, pattern_fill = Categories), 
    colour                   = 'black', 
    pattern_density          = 0.35, 
    pattern_key_scale_factor = 1.3) +
  theme_bw() +
  labs(
    title    = "Sample Plot Illustrating Double-Coding for Accessibility",
    subtitle = "Using Color and Patterns"
  ) +
  scale_pattern_fill_viridis_d() + 
  theme(legend.position = 'none') + 
  coord_fixed(ratio = 1)

sample_plot

```

Now, fill in the blanks in the following code chunk to improve the accessibility of the penguin species visualization in the same way:

```{r pattern-penguins}
penguins %>%
  group_by(species) %>%
  summarise(mean_bill = mean(bill_length_mm, na.rm = TRUE)) %>%
  ggplot(mapping = aes(x = fct_reorder(species, mean_bill), y = mean_bill, fill = species)) +
  geom_col_pattern(
    aes(pattern = _____ , fill = _____, pattern_fill = _____,
    colour                   = 'black', 
    pattern_density          = 0.35, 
    pattern_key_scale_factor = 1.3) +
  theme_bw() +
  scale_pattern_fill______ + 
  theme(legend.position = 'none') + 
  coord_flip() +
  labs(title = "Average Bill Length of Three Penguin Species", x = "Penguin Species", y = "Average Bill Length in Millimeters", fill = "Penguin Species") 
```

üß∂ ‚úÖ ‚¨ÜÔ∏è *This is another good place to pause, knit, commit changes with the commit message "Add answer for Ex 4", and push. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.*

5. Compare your color palette and alternative text for this data visualization with others in your group. As a group, combine your ideas to decide on the final data visualization.

üß∂ ‚úÖ ‚¨ÜÔ∏è *You should pause again, commit changes with the commit message "Add answer for Ex 4", and push. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.*

6. Reflection: What's difficult about applying this criteria to more complex visualizations? What purpose do these elements provide for you as the creator of data visualizations as well as your audience?

üß∂ ‚úÖ ‚¨ÜÔ∏è *Yay, you're done! Commit all remaining changes, use the commit message "Finish Lab X!* üí™*", and push. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards. Before you wrap up the assignment, make sure all documents are updated on your GitHub repo.*
